<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>KAFKA基本概念介绍 &#8212; doczhao 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="KAFKA安装及使用" href="kafka-quickstart.html" />
    <link rel="prev" title="Haking On Kafka（P-version）" href="../index-kafka.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="kafka-quickstart.html" title="KAFKA安装及使用"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../index-kafka.html" title="Haking On Kafka（P-version）"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">doczhao 1.0.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index-kafka.html" accesskey="U">Haking On Kafka（P-version）</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="kafka">
<h1>KAFKA基本概念介绍<a class="headerlink" href="#kafka" title="Permalink to this headline">¶</a></h1>
<p>依据官网的描述，kafka是一个分布式流处理平台，那么什么是分布式流处理平台？</p>
<p>一个流处理平台，至少包括3个主要的功能：</p>
<ol class="arabic simple">
<li>类似于消息队列系统，可以实现流数据的发布(publish)和订阅(subscribe)功能。</li>
<li>能够对流数据提供高容错的持久化存储功能。</li>
<li>能够实时处理流数据。</li>
</ol>
<p>KAFKA一般应用于如下两种场景:</p>
<ol class="arabic simple">
<li>构建实时流处理管道，可靠的实现系统或应用之间的数据流通。</li>
<li>构建实时流处理应用，能够对流数据进行处理和响应。</li>
</ol>
<p>为了更好的了解KAFKA，首先需要了解一些基本的概念。</p>
<ol class="arabic simple">
<li>KAFKA是可以运行在一个或者多个服务器上的集群应用，这些服务器可以跨数据中心部署。</li>
<li>KAFKA是按照归类存储流数据记录。该归类称之为topic。</li>
<li>每一条记录由一个键、一个值和一个时间戳构成。</li>
</ol>
<p>同时，KAFKA自身提供4类主要的API接口。</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/kafka-apis.png"><img alt="kafka-apis" src="../_images/kafka-apis.png" style="width: 80%;" /></a>
</div>
<ol class="arabic simple">
<li><cite>Producer API</cite> 该API允许应用程序向一个或多个KAFKA主题发布流数据。</li>
<li><cite>Consumer API</cite> 该API允许应用程序订阅一个或者多个主题，并处理流数据。</li>
<li><cite>Streams API</cite> 允许应用程序充当流处理器，使用来自一个或多个主题的输入流，并生成一个输出流到一个或多个输出主题，从而有效地将输入流转换为输出流。</li>
<li><cite>Connector API</cite> 允许构建和运行将Kafka主题连接到现有应用程序或数据系统的可重用生产者或消费者。例如，连接到关系数据库的连接器可能捕获对表的每个更改。</li>
</ol>
<p>在KAFKA应用中，客户端和服务器之间的通信是通过一个简单的、高性能的、与语言无关的TCP协议完成的。该协议是经过版本控制的，并与旧版本保持向后兼容性。官方为我们提供了一个Java客户机，但是客户机可以使用多种语言。</p>
<div class="section" id="id1">
<h2>主题和日志<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>深入了解KAFKA，首先需要了解Topic的概念。</p>
<p>主题是发布记录的类别或提要名称。Kafka中的主题总是多订阅者;也就是说，主题可以有0个、1个或多个订阅写入主题的数据的使用者。
对于每个主题，Kafka集群都维护一个分区日志。如下图所示:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/log_anatomy.png"><img alt="log_anatomy" src="../_images/log_anatomy.png" style="width: 80%;" /></a>
</div>
<p>每个分区都是一个有序的、不可变的记录序列，这些记录被不断添加到结构化提交日志中。分区中的记录被分配一个顺序的id号，称为惟一标识分区中的每个记录的偏移量。
Kafka集群使用可配置的保留期可以持久地保存所有已发布的记录(不管它们是否已被消耗)。例如，如果保留策略被设置为两天，那么在发布记录后的两天内，记录是可用的，在这两天之后，记录将被丢弃以释放空间。Kafka的性能在数据大小方面实际上是恒定的，所以长时间存储数据不是问题。</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/log_consumer.png"><img alt="log_consumer" src="../_images/log_consumer.png" style="width: 80%;" /></a>
</div>
<p>事实上，在每个使用者的基础上保留的唯一元数据是该使用者在日志中的偏移量或位置。这个偏移量由使用者控制:通常情况下，使用者在读取记录时将线性推进其偏移量，但实际上，由于位置由使用者控制，所以它可以按自己喜欢的任何顺序使用记录。例如，使用者可以重置到旧的偏移量来重新处理过去的数据，或者跳过到最近的记录，从“现在”开始消费。
这些特性的组合意味着Kafka的消费者非常方便使用，例如，用户可以使用官方提供的的命令行工具跟踪任何主题的内容，而无需更改任何现有使用者使用的内容。
日志中的分区有几个用途。首先，它们允许日志扩展到超出单个服务器存储限制的大小。每个单独的分区必须适合承载它的服务器，但是主题可能有许多分区，因此它可以处理任意数量的数据。其次，它们作为并行的单位，稍后我们会详细介绍。</p>
</div>
<div class="section" id="distribution">
<h2>分发:Distribution<a class="headerlink" href="#distribution" title="Permalink to this headline">¶</a></h2>
<p>日志的分区分布在Kafka集群中的服务器上，每个服务器处理分区共享的数据和请求。为了容错，每个分区在可配置数量的服务器之间复制。</p>
<p>每个分区都有一个服务器充当“领导者”，以及零个或多个服务器充当“追随者”。leader处理分区的所有读和写请求，而follower则被动地复制leader。如果领导者失败了，一个追随者将自动成为新的领导者。每个服务器作为它的一些分区的领导者和其他分区的追随者，因此负载在集群中得到了很好的平衡。</p>
</div>
<div class="section" id="geo-replication">
<h2>异地备份Geo-Replication<a class="headerlink" href="#geo-replication" title="Permalink to this headline">¶</a></h2>
<p>Kafka MirrorMaker为集群提供地理复制支持。使用MirrorMaker，可以跨多个数据中心或云区域复制消息。用户可以在用于备份和恢复的主动/被动场景中使用它;或者在活动/活动场景中放置更接近用户的数据，或者支持数据局部性需求。</p>
</div>
<div class="section" id="producers">
<h2>生产者Producers<a class="headerlink" href="#producers" title="Permalink to this headline">¶</a></h2>
<p>生产者将数据发布到他们选择的主题。生产者负责选择要分配给主题中的哪个分区的记录。这可以以一种简单的循环方式来平衡负载，也可以根据某个语义分区函数(比如基于记录中的某个键)来完成。</p>
</div>
<div class="section" id="consumers">
<h2>消费者Consumers<a class="headerlink" href="#consumers" title="Permalink to this headline">¶</a></h2>
<p>使用者用使用者组名称给自己打上标签，发布到主题的每个记录都交付给每个订阅使用者组中的一个使用者实例。使用者实例可以位于单独的进程中，也可以位于单独的机器上。</p>
</div>
<div class="section" id="guarantees">
<h2>系统保障Guarantees<a class="headerlink" href="#guarantees" title="Permalink to this headline">¶</a></h2>
<p>KAFKA提供如下可靠性保障功能：</p>
<ol class="arabic simple">
<li>生产者发送到特定主题分区的消息将按照发送的顺序追加。也就是说，如果记录M1由与记录M2相同的生产者发送，且首先发送M1，那么M1的偏移量将小于M2，并且出现在日志的前面。</li>
<li>使用者实例按照存储在日志中的顺序查看记录。</li>
<li>对于复制因子为N的主题，我们将容忍最多N-1个服务器故障，而不会丢失提交到日志中的任何记录。</li>
</ol>
</div>
<div class="section" id="id2">
<h2>KAFKA消息系统<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>传统的消息传递有两种模式:排队模式和发布-订阅模式。在队列模式中，使用者池可以从服务器读取数据，每条记录都被发送到其中一条;在发布-订阅模式中，记录被广播给所有消费者。这两种模式各有优缺点。排队模式的优点在于，它允许您将数据处理划分到多个使用者实例上，从而可以扩展处理。但队列不是多订阅的&#8211;一旦一个进程读取了数据，它就消失了。发布-订阅模式允许您将数据广播到多个进程，但无法进行消息伸缩处理，因为每条消息都要发送到每个订阅者。</p>
<p>与传统消息传递模式不同，Kafka提供了一个消费者组的概念，一个消息可以被多个消费者组消费，但是只能被一个消费者组里的一个消费者消费，这样当只有一个消费者组时就等同与P2P模型，当存在多个消费者组时就是PUB/SUB模型。
KAFKA的消费群体概念概括了这两个概念。与队列一样，使用者组允许您将处理划分为一组进程(使用者组的成员)。与发布-订阅一样，Kafka允许您向多个消费群体广播消息。</p>
</div>
<div class="section" id="id3">
<h2>KAFKA存储系统<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>写入Kafka的数据被写入磁盘并复制到容错磁盘。Kafka允许生产者等待确认，这样写入就不会被认为是完整的，直到它被完全复制并保证即使写入的服务器失败也会保持。</p>
<p>Kafka使用的磁盘结构具有良好的伸缩性&#8211;无论服务器上有50 KB还是50 TB的持久数据，Kafka都将执行相同的操作。</p>
</div>
<div class="section" id="id4">
<h2>KAFKA流处理系统<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>KAFKA除了支持读取、写入和存储数据流外，还支持流的实时处理。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">看支持平台表，Docker对Ubuntu的支持应该是最全面的。</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">KAFKA基本概念介绍</a><ul>
<li><a class="reference internal" href="#id1">主题和日志</a></li>
<li><a class="reference internal" href="#distribution">分发:Distribution</a></li>
<li><a class="reference internal" href="#geo-replication">异地备份Geo-Replication</a></li>
<li><a class="reference internal" href="#producers">生产者Producers</a></li>
<li><a class="reference internal" href="#consumers">消费者Consumers</a></li>
<li><a class="reference internal" href="#guarantees">系统保障Guarantees</a></li>
<li><a class="reference internal" href="#id2">KAFKA消息系统</a></li>
<li><a class="reference internal" href="#id3">KAFKA存储系统</a></li>
<li><a class="reference internal" href="#id4">KAFKA流处理系统</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../index-kafka.html"
                        title="previous chapter">Haking On Kafka（P-version）</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="kafka-quickstart.html"
                        title="next chapter">KAFKA安装及使用</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/kafka/kafka-intrduction.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="kafka-quickstart.html" title="KAFKA安装及使用"
             >next</a> |</li>
        <li class="right" >
          <a href="../index-kafka.html" title="Haking On Kafka（P-version）"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">doczhao 1.0.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index-kafka.html" >Haking On Kafka（P-version）</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, zhaoyuanjie.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.
    </div>
  </body>
</html>